---
title: "HS_Linked"
output: html_document
date: "2025-06-21"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Load Packages 

```{r}
library(dplyr)
library(readr)
```

# Verify the structure of the original .ped file

```{r}
# Define the file path
Original_HS_ped_path <- "/Users/huncho/Desktop/Forensic_Kinship/94_SNP_Simulation/HS_Simulation/Input_Files/HSvUN_94.ped"

# Load the Linked file
Original_HS_ped <- read_delim(Original_HS_ped_path, delim = "\t", col_names = FALSE)

# Display structure of the file as a spreadsheet-style data viewer 
View(Original_HS_ped)
```

# Code to run the Merlin Simulation for HS_Linked which requires: 
# 1) Defining the path to the 4 input files: .freq, .ped, .map, .dat
# 2) Setting the random seed
# 3) Setting the number of re-runs/iterations
# 4) Saving the intermediate files and lnlikelihoods produced

```{bash}
merlin -p ../Original_Files/HSvUN_94.ped -d ../Original_Files/Markers_ForenSeq_SNP.dat -m ../Original_Files/Linked_ForenSeqSNP.map -f ../Original_Files/WBFreq_94_SNPs_FamLink.freq -r 3898 --simulate --reruns 50000 --likelihood --information --markerNames --quiet --save --prefix HS_Linked/HS_Linked > likelihoods_HS_Linked_summary.txt
```

# Verify the structure of the 1st .ped File produced from the simulation

```{r}
# Define file paths
Simulated_HS_Ped1_path <- "/Users/huncho/Desktop/Forensic_Kinship/94_SNP_Simulation/HS_Simulation/HS_Linked/merlin-00003898-00001-replicate.ped"

# Load the Linked file
Simulated_HS_Ped1 <- read_delim(Simulated_HS_Ped1_path, delim = "\t", col_names = FALSE)

# Display structure of the files
View(Simulated_HS_Ped1)
```